name: CI/CD Pipeline Statique

on:
  push:
    branches:
      - main
  # Permet un déclenchement manuel depuis l'interface GitHub
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest  # Environnement Linux (similaire à WSL)
    
    steps:
      - name: Checkout du code
        uses: actions/checkout@v4
        
      - name: Rendre les scripts exécutables (Aspect Sécurité Linux)
        run: chmod +x scripts/*.sh

      - name: Exécuter la phase de Build (Script Shell)
        run: ./scripts/build.sh

      - name: Exécuter les tests (Script Shell)
        run: ./scripts/test.sh
        
      # Simule le déploiement en uploadant les fichiers de build
      - name: Déploiement (Simulé)
        # Ici, on simule un upload des artefacts pour la "production"
        uses: actions/upload-artifact@v4
        with:
          name: site-statique
          path: dist/
          retention-days: 1
